/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */

//!AKO BI EKSPLICITNO SLIJEDILI MAXWELL JEDNADZBE ONDA BI AMPLITUDU SIGNALA MORALI MNOZIT S -deltat/permitivity ODNOSNO U NASEM SLUCAJU S NORMALIZACIJOM EL POLJA SA (deltat * c0) / permitivity

//!AKO IMAMO VISE CVOROVA UNUTAR KRUGA TADA CE SE ZA SVAKI CVOR I ZIDOVE KOJI IDU IZ NJEGA ODRADITI POMICANJE KAKO TREBA ODNOSNO SA UZASTOPNIM POMICANJIMA CEMO DOBITI ONO STA ZELIMO

//!AKO STAVIMO LINEARNO TAD CEMO IMAT POSTUPNIJI PRIJELAZ U CRNU BOJU ALI CEMO NAGLIJE UVODIT SIGMA U MODEL -> NUMERICKA STABILNOST TRADE OFF

//!AKO ZELIMO OGRANICIT PO NEOBRADENIMA ONDA POSTAVIT OVDJE UVJET DA JE wallsLossMatrix VRIJEDNOST < 0 ALI JE ONDA POTREBNO NAKNADNO OBRADIT TOCKE KOJE SU PROPUSTENE I INTERPOLIRAT IM BOJU NA NEKI NACIN(PREKO SUSJEDA)

//!AMPLITUDA SIGNALA ZASLUZNA JE ZA UNOSE ENERGIJE U MODEL -> AKO JE ONA PREVELIKA ONDA CEMO IMAT VELIKU SNAGU DOSTA VEĆU OD INTERVALA [-20dBm, -140dBm] I SVE CE SE BOJAT U CRVENO

//!CAK I AKO SE STAVI DOVOLJNO DEBEL PML BOUNDARY LEVEL I APSORBIRA SE SVE PRIJE RUBOVA SE ISTO DOGODI -> NIJE DO DIRICHLETA

//!FAKTOR POTENCIJE NAM DAJE GRADIJENT KOJI CE LAGANO POVECAVAT SIGME -> VRIJENDOSTI BLIZU 1 SU SKORO SKROZ UZ RUB A DALJE VRIJENDOSTI SU DOSTA BLIZU 0

//!IAKO SE KOD MOZE OPTIMIZIRAT KREIRANJEM METODA S OPERACIJAMA ZA SVAKU ITERACIJU TO NE RADIMO JER SE S TIM U SVAKOJ ITERACIJI POZIVA FUNKCIJA ŠTO JE DOSTA SPORIJE OD INLINE IZVRSAVANJA

//!ISTO TAKO AKO SE STAVI DUPLI LOSS U REGIJAMA PREKPAPANJA ODNOSNO DA POSTOJI I SIGMAX I SGIAMY ISTO STVAR SE DOGODO U RUBOVIMA

//!IZNIMKA SU DOUBLE ORPHAN ZIDOVI GDJE UVIJEK IREIRAMO circle_part PA IH KASNIJE OBRADUJEMO

//!JEDNADZBA ZIDA JE PREDSTAVLJENA S OBJEKTOM KOJI JE JEDINSTVEN U ODNOSU NA SVE DRUGE PA STOGA MOZEMO JEDNADZBE ZIDOVA USPOREDIVATI PREMA REFERENCAMAOBJEKTA

//!MI ZAPRAVO OVDE RADIMO POMICANJE TROKUTA U ODNOSU NA VRH SOBE KOJI SE NALAZI UNUTAR NJEGA ISTO KAO STO RADIMO SA KRUZNIM LUKOM -> ZATO I UZIMAMO TOCKU SJECISTA A NE CVOR SOBE

//!MOGUC SLUCAJ U KOJEM SU OBE TOCKE PROSTORIJE UNUTAR KRUZNOG LUKA -> ORPHAN WALL KOJI JE CIJELI UNUTRA

//!MOGUCE DA JE NEKA TOCKA NA VISE ZIDOVA I ONDA IMA VISE JEDNADZBI PRAVACA -> MOZEMO SPUSTAT/POMJERAT NA VISE PRAVACA

//!MOZDA JE SLUCAJ PRENAGLA PROMJENA IZMEDU SUSJEDNIH SIGMA VRIJENDOSTI ZBOG KOJE SE DOGODI OVO JER CE BIT VECA RAZLIKA IZMEDU SUSJEDNIH SIGMA VRIJENDOSTI?

//!NA IZLASKU IZ PETLJE TREBAMO SPOJIT ZADNJI stop SA PRVIM START CLANOM DA SE SPOJI POLIGON IZMEDU NJIH

//!NAMA TO NE PASE JER ZELIMO IMAT play/pause KONTROLU I IMAT MOGUCNOST INTERRUPTAT IZVRSENJE

//!NE IZRACUNAVAJ NOVU JEDNADZBU NAKON ODMAH NAKON POMJERANJA JER NAS I KOD STOP SLUCAJA ZANIMA SJECISTE SA pointApointBEquation KOJA JE BILA NA POCETKU( U TEORIJI NE BI TREBALO BIT PROBLEMA JER I NAKON POMJERANJA NOVI PRAVAC IDE KROZ TOCKU KOJU NISMO POMJERILI ALI DODE DO AKUMULIRANJA GRESKE ZBOG NEPRECIZNOSTI PA isPointRayCrossingWallSpike ZNA NE DETEKIRAT SJECISTA KOJA TREBA

//!ONDA BI TREBALI ILI PRILAGODIT SKALU ZA SNAGU(npr u dBmW) ILI NOISE LEVEL DA BI NA KRAJU DOBILI ISTU PALETU BOJA KAO I BEZ TOGA

//!OVO NAM USPORAVA MALO KOD -> POSTOJE OPCIJE ILI TO RADIT SVAKO ODREDENI BROJ ITERACIJA ALI ONDA U SLUCAJU DA 1 ITERACIJA TRAJE DUGO USER CE IMAT OSJECAJ DAPLAYER NE REAGIRA NA NJEGOVE INPUTE

//!POTREBNO METODE IMENOVAT S POCETNIM MALIM SLOVOM JER U SUPROTNOM SE DOGADA $RefreshReg$ is not defined -> RAZLOG: https://stackoverflow.com/a/76774967/13825085

//!POTREBNO SE SVEST U KOORDINATNI SUSTAV GRIDA -> PREMA UDALJENOSTI OD RUBOVA U METRIMA MOZEMO ODREDIT U KOJE CELIJE/PRAVCE SE PRESLIKAVAJU LINIJE ZIDOVA U GRIDU

//!PRIMJER NUMERICKE STABILNOST SE MOZE VIDIT AKO EKSPONENT STAVIMO <1(NPR 1/2) TADA STA MODEL IDE DALJE DOBIVAMO VECE REFLEKSIJE

//!Poligon je minimalno trokut pa stoga imamo sigurno barem 3 tocke u polygon nizu

//!S TIM BI SAMO DOBILI DRUKCIJE OMJERE EL POLJA ODNOSNO ONI BI SE NALAZILI U NEKOM DRUGOM MANJEM INTERVALU -> KONKRETNO KOD NASEG PRIMJERA ODREDIVANJA SNAGE IMALI BI SLUCAJ DA JE SVAKA VRIJEDNOST EL POLJA ISPOD VRIJEDNOSTI SUMA I IMALI BI SVE PLAVO

//!SIMULACIJA IMA NEKE NUMERICKE GRANICE S OVIM sigmalValueScaleFactor JER ZNA PODIVLJAT U RUBOVIMA KAD SE PREVISE POVECA -> TO NAM BAS I NE PASE JER NAM JE BOLJE DA POVECAVMO VRIJEDNOSTI SIGMI A STANJIMO PML DEBLJINU JER NAM ONA POVECAVA MATRICU PREVISE

//!STROGA NEJEDNAKOST TAKO DA NE OBRADUJEMO TOCKE NA KOJE SMO VEC POMAKNUTI ODNOSNO KADA JE CVOR ZIDA JEDNAK start/stop TOCKI OD KRUZNOG LUKA

//!SVE start ILI stop UNUTAR SVOG wallEquation CE SADRZAVATI NEKE OD JEDNADZBI OVIH ZIDOVA

//!SVI positionRoomDoubleOrphanWalls ZIDOVI SU JEDINSTVENI ODNOSNO NEMA DUPLICIRANIH ZIDOVA PA JE JEDNADZBA PRAVCA OD SVAKOG ZIDA JEDINSTVENA U ODNOSU NA DRUGE

//!TREBALI BI IMATI SAMO SLUCAJEVE KADA SE ILI OBE NE SIJEKU ILI SE OBE SIJEKU NAKON POMAKA, NE BI TREBALO BIT POLOVICNIH SLUCAJEVA

//!TRENUTNA LOGIKA NE RADI ZA ORPHAN ZIDOVE KOJI SU UNUTAR KRUGA  JER NE PRONALAZI SJECISTE ZRAKE S NIJEDNIM OD ZIDOVA, PROMIJENI LOGIKU TAKO DA I NJIH ZADOVOLJIMO?

//!TRENUTNA LOGIKA NE RADI ZA ORPHAN ZIDOVE KOJI SU UNUTAR KRUGA JER NE PRONALAZI SJECISTE ZRAKE S NIJEDNIM OD ZIDOVA, PROMIJENI LOGIKU TAKO DA I NJIH ZADOVOLJIMO?

//!U Hx I Hy SE NALAZE VRIJEDNOSTI ZA TRENUTNKE t + 1/2deltat A U Ez ZA TRENUTKE t + deltat + H I E SU POMAKNUTI U PROSTORU ZA 1/2 GRID STEPA

//!UZMI I OBRADENE I NEOBRADENE JER U NEKIM SLUCAJEVIMA OSTAJU NEOBRADENI PIKSELI KOJI NISU DETEKTIRANI NA NIJEDNOJ ZRACI(-1 VRIJEDNOST)

//!WEB WORKER TAKODER TREBA PROMATRAT KAO SINGLE THREAD KOJI U SLUCAJU DA IZVRSAVAMO SINKRONO NEKI KOD NE MOZE ODRADIT onMessage INTERUPT JER JE THREAD STALNO BLOKIRAN

//!ZASAD UZMIMO/2 ALI KASNIJE VIDIT JEL OK SA 1.5 JER CE TO POVECAT DELTA T I SMANJIT BROJ ITERACIJA

//!ZASAD maxRefractionIndex KORISTIMO SAMO ZA IZRACUN VREMENA PROPAGACIJE

//!ZATO GENERALNO NIJE BITNA AMPLITUDA SIGNALA(A S NJOM I PREDZNAK) PA ZA ADITIVNI IZVOR SAMO NADODAJEMO AMPPLITUDU CISTOG SINUSNOG SIGNALA

//!ZATO MAKSIMALNU AMPLITUDU SIGNALA POSTAVLJAMO NA ONU VRIJEDNOST KOJA DAJE RSSI OD 0dBm ODNOSNO SIGNAL IMA SNAGU OD 1mW U IZVORU -> dBm = 0 -> dBW = -30 -> 10log10(x^2) = -30

//!ZATO STAVLJAMO IZVRSAVANJE SVAKE ITERACIJE NA ASYNC DIO I OCITAVAMO PRIJE SVAKE ITERACIJE JE LI DOSLO DO INTERUPTA I HANDLEAMO GA

//!ZBOG TOGA POSTAVLJAMO I DODATNI UVJET UZ PROVJERE KOORDINATA DA TOCKA NE SMIJE IMAT angle PROPERTY JER ON POSTOJI SAMO ZA UBACENE TOCKE CVOROVA SOBE UNUTAR POLIGONA A NE ZA start,stop I SREDISTE KRUGA

//!ne dozvoljavamo jednakost -> JEDINO U UVOM SLUCAJU SE PROSLIJEDUJE PARAMETAR wallEquationSlope

//*!TOCKE POREDANE PO REDOSLIJEDU OD IZVORA DO TRENUTNE TOCKE U (x,y) FORMATU -> TOCKE NA KRAJU NIZA SU DALJE OD IZVORA
